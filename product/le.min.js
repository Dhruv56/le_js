/*
 Copyright 2013 Logentries.
 Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
*/
'use strict';var LE=function(b){function g(a){var h=(Math.random()+Math.PI).toString(36).substring(2,10),e=a.trace,f=a.page_info,n=a.token,g=a.print,s=a.ssl,k=[],l=!1,p=!1;if(a.catchall){var q=b.onerror;b.onerror=function(d,a,c){m({error:d,line:c,location:a}).level("ERROR").send();return q?q(d,a,c):!0}}var t=function(){var d=b.navigator||{doNotTrack:void 0},a=b.screen||{};return{url:(b.location||{}).pathname,referrer:document.referrer,screen:{width:a.width,height:a.height},window:{width:b.innerWidth,
height:b.innerHeight},browser:{name:d.appName,version:d.appVersion,cookie_enabled:d.cookieEnabled,do_not_track:d.doNotTrack},platform:d.platform}},u=function(){var a=null,a=Array.prototype.slice.call(arguments);if(0===a.length)throw Error("No arguments!");return a=1===a.length?a[0]:a},m=function(a){var b=u.apply(this,arguments),c={event:b};"never"===f||p&&"per-entry"!==f||(p=!0,"undefined"===typeof b.screen&&"undefined"===typeof b.browser&&m(t()).level("PAGE").send());e&&(c.trace=h);return{level:function(a){if(g&&
"undefined"!==typeof console&&"PAGE"!==a)try{console[a.toLowerCase()].call(console,c)}catch(b){console.log(c)}c.level=a;return{send:function(){var a=[],b=JSON.stringify(c,function(c,b){if("undefined"===typeof b)return"undefined";if("object"===typeof b&&null!==b){var d;a:{for(d=0;d<a.length;d++)if(b===a[d])break a;d=-1}if(-1!==d)return"\x3c?\x3e";a.push(b)}return b});l?k.push(b):r(n,b)}}}}};this.log=m;var r=function(a,h){l=!0;var c=function(){b.ActiveXObject&&(b.XMLHttpRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")});
return new XMLHttpRequest}();c.onreadystatechange=function(){4===c.readyState&&(400<=c.status?(console.error("Couldn't submit events."),410===c.status&&console.warn("This version of le_js is no longer supported!")):(301===c.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),0<k.length?r(a,k.shift()):l=!1))};c.open("POST",(s?"https://":"http://")+"js.logentries.com/v1/logs/"+n,!0);c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("Content-type",
"text/json");c.send(h)}}var f,e=function(a){if(f)return f.log.apply(this,arguments);throw Error("You must call LE.init(...) first.");};return{init:function(a){var b={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1};if("object"===typeof a)for(var e in a)b[e]=a[e];else if("string"===typeof a)b.token=a;else throw Error("Invalid parameters for init()");if(void 0===b.token)throw Error("Token not present.");f=new g(b);return!0},log:function(){e.apply(this,arguments).level("LOG").send()},warn:function(){e.apply(this,
arguments).level("WARN").send()},error:function(){e.apply(this,arguments).level("ERROR").send()},info:function(){e.apply(this,arguments).level("INFO").send()}}}(this);