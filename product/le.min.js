/*
 Copyright 2013 Logentries.
 Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
*/
'use strict';var LE=function(d){function h(e){var t=(Math.random()+Math.PI).toString(36).substring(2,10),f=e.trace,g=e.page_info,p=e.token,h=e.print,u=e.ssl,k=[],l=!1,q=!1;if(e.catchall){var r=d.onerror;d.onerror=function(a,b,c){m({error:a,line:c,location:b}).level("ERROR").send();return r?r(a,b,c):!0}}var v=function(){var a=d.navigator||{doNotTrack:void 0},b=d.screen||{};return{url:(d.location||{}).pathname,referrer:document.referrer,screen:{width:b.width,height:b.height},window:{width:d.innerWidth,
height:d.innerHeight},browser:{name:a.appName,version:a.appVersion,cookie_enabled:a.cookieEnabled,do_not_track:a.doNotTrack},platform:a.platform}},n=function(a){if("object"!==typeof a&&!Array.isArray(a)||null===a)return"undefined"===typeof a?"undefined":null===a?"null":a;for(var b in a)a[b]=n(a[b]);return a},w=function(){var a=null,a=Array.prototype.slice.call(arguments);if(0===a.length)throw Error("No arguments!");if(1===a.length)a=a[0];else{for(var b in a)a[b]=n(a[b]);a=a.join(" ")}return a},m=
function(a){var b=w.apply(this,arguments),c={event:b};"never"===g||q&&"per-entry"!==g||(q=!0,"undefined"===typeof b.screen&&"undefined"===typeof b.browser&&m(v()).level("PAGE").send());f&&(c.trace=t);return{level:function(a){h&&("undefined"!==typeof console&&"PAGE"!==a)&&console[a.toLowerCase()].call(console,c);c.level=a;return{send:function(){var a=JSON.stringify(n(c));l?k.push(a):s(p,a)}}}}};this.log=m;var s=function(a,b){l=!0;var c=function(){d.ActiveXObject&&(d.XMLHttpRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")});
return new XMLHttpRequest}();c.onreadystatechange=function(){4===c.readyState&&(400<=c.status?(console.error("Couldn't submit events."),410===c.status&&console.warn("This version of le_js is no longer supported!")):(301===c.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),0<k.length?s(a,k.shift()):l=!1))};c.open("POST",(u?"https://":"http://")+"js.logentries.com/v1/logs/"+p,!0);c.setRequestHeader("X-Requested-With","XMLHttpRequest");c.setRequestHeader("Content-type",
"text/json");c.send(b)}}var g,f=function(e){if(g)return g.log.apply(this,arguments);throw Error("You must call LE.init(...) first.");};return{init:function(e){var d={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1};if("object"===typeof e)for(var f in e)d[f]=e[f];else if("string"===typeof e)d.token=e;else throw Error("Invalid parameters for init()");if(void 0===d.token)throw Error("Token not present.");g=new h(d);return!0},log:function(){f.apply(this,arguments).level("LOG").send()},warn:function(){f.apply(this,
arguments).level("WARN").send()},error:function(){f.apply(this,arguments).level("ERROR").send()},info:function(){f.apply(this,arguments).level("INFO").send()}}}(this);