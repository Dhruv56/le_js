/*
 Copyright 2013 Logentries.
 Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
*/
'use strict';var LE=function(g){function k(b){var d=b.token,f=!0,m=b.ssl,l=[];if(b.onerror){var n=g.onerror;g.onerror=function(d,a,e){p({err:d,l:e,u:a});n&&n(d,a,e)}}var p=function(b){var a={};if(1===arguments.length){var e=arguments[0];if("string"===typeof e)a=e;else if("object"===typeof e){var a=e,e=[],c;for(c in a)e.push(c+"\x3d"+a[c]);a=e.join("\x26")}}else a=Array.prototype.slice.call(arguments);q(d,a)};this.log=p;var k=function(){if("undefined"!==typeof WebSocket){var b=new WebSocket((m?"wss://":
"ws://")+"js.logentries.com/logs"+d);b.onclose=function(a){400<=a.code&&(console.warn(a),f=!1)};b.onopen=function(){for(;0==!l.length;)b.send(l.pop())};return b}return!1},h,q=function(b,a){var e=function(){g.ActiveXObject&&(g.XMLHttpRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")});return new XMLHttpRequest};"undefined"===typeof h&&(h=k());var c=h?h:e();f&&(c instanceof XMLHttpRequest?(c.onreadystatechange=function(){4===c.readyState&&400===c.status&&console.warn("Couldn't submit events. Is your token valid?")},
c.open("POST",(m?"https://":"http://")+"js.logentries.com/logs/"+d,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.send(a)):1==c.readyState?c.send(a):l.unshift(a))}}var f;return{init:function(b){var d={};"string"===typeof b?d.token=b:"object"===typeof b&&(d=b);d.ssl=!1;d.onerror=d.onerror||!1;if(void 0===d.token)throw Error("Token not present.");f=new k(b);return!0},log:function(){if(f)f.log.apply(this,arguments);
else throw Error("You must call LE.init(...) first.");}}}(this);