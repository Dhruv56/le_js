/*
 Copyright 2013 Logentries.
 Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
*/
'use strict';var LE=function(g){function k(a){var e=a.token,f=!0,n=a.ssl,l=[];if(a.onerror){var p=g.onerror;g.onerror=function(m,c,d){q({err:m,l:d,u:c});p&&p(m,c,d)}}var q=function(m){var c={};if(1===arguments.length){var d=arguments[0];"string"===typeof d?c={event:d}:"object"===typeof d&&(c=d)}else c={event:Array.prototype.slice.call(arguments)};var d=r,b,a=[];for(b in c)a.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(c[b]));b=a.join("\x26");d(e,b)};this.log=q;var k=function(){if("undefined"!==
typeof WebSocket){var a=new WebSocket((n?"wss://":"ws://")+"js.logentries.com/");a.onclose=function(a){400<=a.code&&(console.warn(a),f=!1)};a.onopen=function(){for(a.send(e);0==!l.length;)a.send(l.pop())};return a}return!1},h,r=function(a,c){var d=function(){g.ActiveXObject&&(g.XMLHttpRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")});return new XMLHttpRequest};"undefined"===typeof h&&(h=k());var b=h?h:d();f&&(b instanceof XMLHttpRequest?(b.onreadystatechange=function(){4===b.readyState&&
400===b.status&&console.warn("Couldn't submit events. Is your token valid?")},b.open("POST",(n?"https://":"http://")+"js.logentries.com/",!0),b.setRequestHeader("X-LE-Token",a),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send(c)):1==b.readyState?b.send(c):l.unshift(c))}}var f;return{init:function(a){var e={};"string"===typeof a?e.token=a:"object"===typeof a&&(e=a);e.ssl=!1;e.onerror=e.onerror||!1;if(void 0===e.token)throw Error("Token not present.");
f=new k(a);return!0},log:function(){if(f)f.log.apply(this,arguments);else throw Error("You must call LE.init(...) first.");}}}(this);